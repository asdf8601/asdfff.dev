---
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = await Astro.glob('./posts/*.md');

const sortedPosts = posts.sort((a, b) => {
  const dateA = new Date(a.frontmatter.date || 0);
  const dateB = new Date(b.frontmatter.date || 0);
  return dateB - dateA;
});
---

<BaseLayout title="posts - wtfm">
  <article>
    <h1>posts</h1>
    
    <p>Longer thoughts on documentation, tools, and engineering.</p>

    <div class="post-list">
      {sortedPosts.length > 0 ? (
        sortedPosts.map(post => (
          <div class="post-entry">
            <time>{post.frontmatter.date}</time>
            <h2><a href={post.url}>{post.frontmatter.title}</a></h2>
            <p>{post.frontmatter.description}</p>
          </div>
        ))
      ) : (
        <p class="empty-state">No posts yet. Add markdown files to src/pages/posts/</p>
      )}
    </div>
  </article>
</BaseLayout>

<style>
  article {
    max-width: 100%;
  }

  h1 {
    margin-bottom: var(--spacing-md);
    text-transform: lowercase;
  }

  .post-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
  }

  .post-entry {
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
  }

  .post-entry:last-child {
    border-bottom: none;
  }

  .post-entry time {
    display: block;
    color: var(--color-text-muted);
    font-size: 0.85rem;
    margin-bottom: var(--spacing-xs);
  }

  .post-entry h2 {
    margin: 0 0 var(--spacing-xs) 0;
    font-size: 1.25rem;
  }

  .post-entry h2 a {
    text-decoration: none;
  }

  .post-entry h2 a:hover {
    text-decoration: underline;
  }

  .post-entry p {
    margin: 0;
    color: var(--color-text);
  }
</style>
